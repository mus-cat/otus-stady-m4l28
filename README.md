# PAM
## Задание выполнялось с использованием VirtualBox 6.1.40, использовался vagrant с box-образом generic/debian11

## Задание:
- Запретить всем пользователям, кроме группы timeless (~~admin~~) логин в выходные (суббота и воскресенье), без учета праздников
- Дать конкретному пользователю права работать с докером и возможность рестартить докер сервис

## Результат:
### I. Запретить всем пользователям, кроме группы timeless логин в выходные (суббота и воскресенье), без учета праздников
- Задача была реализована за счёт использования модуля **pam_script**. Для его функционирования в файл **/etc/pam.d/sshd** была добавлена строка `auth required pam_script.so` и написан скрипт **datetest.sh** (в системе он размещается под другим именем)
- Для тестрования были созданы пользователи **testadm**, **user1** и **user2** (у всех пароль 12345), которые входят в группу **timeless**. Тестирование возможности входа осуществлялся с хостовой машины  командой `ssh -p 2222 <user_name>@127.0.0.1`


### II. Дать конкретному пользователю (testadm) права работать с докером и возможность рестартить докер сервис
- Возможность управлять **Docker** ползователю **testadm** была предоставлена за счёт включения его в группу **Docker**
- Возможность запуска/остановки сервиса **Docker** была реализована за счёт использовавния сервиса **PolKit**. В связи с относительно старой версией **PolKit** (ver. 0.105) присутствующей в репозитории **Debian** отсутствует возможность тонкой настройки предоставляемых прав, пользователь **testadm** может управляеть всеми сервисам

### Файлы:
- **Vagrant** - файл для создания ВМ и запуска ansible
- **configpam.yml** - ansible playbook выполняющий настройку ОС внутри ВМ
- **datetest.sh** - скрипт выполняемый для проверки возможности предоставления пользователю доступа к системе на основании принадлежности к опеределенной группе и дня недели
- **10-systemd-auth.pkla** - конфигурационный файл для **PolKit** разрешающий определенному непревилегированному пользователю останавливать/запускать сервисы с использованием **systemctl**
